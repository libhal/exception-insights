\doxysection{elf\+\_\+parser.\+hpp}
\hypertarget{elf__parser_8hpp_source}{}\label{elf__parser_8hpp_source}\index{/home/mchan/Senior\_Project/exception-\/insights/include/elf\_parser.hpp@{/home/mchan/Senior\_Project/exception-\/insights/include/elf\_parser.hpp}}
\mbox{\hyperlink{elf__parser_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <elf.h>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <err.h>}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <fcntl.h>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <stdlib.h>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <sysexits.h>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <unistd.h>}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <gelf.h>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <libelf.h>}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <print>}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <unordered\_map>}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <variant>}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classElfParser}{ElfParser}}}
\DoxyCodeLine{00029\ \{}
\DoxyCodeLine{00030\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00036\ \ \ \ \ \mbox{\hyperlink{classElfParser_a57e4cf833897e7de481a67e1af015e07}{ElfParser}}(std::string\_view\ p\_file\_name)}
\DoxyCodeLine{00037\ \ \ \ \ \ \ :\ \mbox{\hyperlink{classElfParser_a926b055d576d22cf90b8aa40dab869d7}{m\_file\_name}}(p\_file\_name)}
\DoxyCodeLine{00038\ \ \ \ \ \{}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (elf\_version(EV\_CURRENT)\ ==\ EV\_NONE)\ \{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ std::println(}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stderr,\ \textcolor{stringliteral}{"{}ELF\ library\ initialization\ failed\ :\ \{\}"{}},\ elf\_errmsg(-\/1));}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{classElfParser_aed6b20ec399e0f1b3ef7fb45c00c6c10}{m\_file}}\ =\ open(\mbox{\hyperlink{classElfParser_a926b055d576d22cf90b8aa40dab869d7}{m\_file\_name}}.c\_str(),\ O\_RDONLY,\ 0))\ <\ 0)\ \{}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ std::println(stderr,\ \textcolor{stringliteral}{"{}\(\backslash\)\{\}\ failed\ to\ open"{}},\ elf\_errmsg(-\/1));}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElfParser_a78a143ec8563a0166d611865cba1fcaa}{fileOpened}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElfParser_a78a143ec8563a0166d611865cba1fcaa}{fileOpened}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{classElfParser_af077fc5dc0eb68893e380a233de38db9}{m\_elf}}\ =\ elf\_begin(\mbox{\hyperlink{classElfParser_aed6b20ec399e0f1b3ef7fb45c00c6c10}{m\_file}},\ ELF\_C\_READ,\ NULL))\ ==\ NULL)\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ std::println(}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stderr,\ \textcolor{stringliteral}{"{}Elf\ file\ failed\ to\ load\ :\ \{\}."{}},\ elf\_errmsg(-\/1));}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElfParser_ad1ccf049355fe35ea313afc4ed3f8d80}{fileLoaded}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElfParser_ad1ccf049355fe35ea313afc4ed3f8d80}{fileLoaded}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classElfParser_ad1ccf049355fe35ea313afc4ed3f8d80}{fileLoaded}}\ \&\&\ \mbox{\hyperlink{classElfParser_a78a143ec8563a0166d611865cba1fcaa}{fileOpened}})\ \{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (elf\_kind(\mbox{\hyperlink{classElfParser_af077fc5dc0eb68893e380a233de38db9}{m\_elf}})\ !=\ ELF\_K\_ELF)\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::println(stderr,\ \textcolor{stringliteral}{"{}\(\backslash\)\{\}\ is\ not\ an\ ELF\ object.\ "{}},\ \mbox{\hyperlink{classElfParser_a926b055d576d22cf90b8aa40dab869d7}{m\_file\_name}});}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ std::println(\textcolor{stringliteral}{"{}\{\}\ \{\}-\/bit\ ELF\ object\(\backslash\)n"{}},}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElfParser_a926b055d576d22cf90b8aa40dab869d7}{m\_file\_name}},}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElfParser_a814e5b369b4aaeafbabfa2f4835ada6b}{m\_elf\_class}}\ ==\ ELFCLASS32\ ?\ 32\ :\ 64);}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElfParser_a267398efbfb43b368038bd167ea997b0}{loadElfHeader}}();}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElfParser_a49dc6599a415b9d7ea70af2360904816}{loadSectionHeader}}();}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElfParser_af9bb815aa5aa30ed0f336fc6ed15f78b}{loadProgramHeader}}();}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00070\ \ \ \ \ \};}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00075\ \ \ \ \ \mbox{\hyperlink{classElfParser_a7be96589fed674c2c316f6a9d1e5e941}{\string~ElfParser}}()}
\DoxyCodeLine{00076\ \ \ \ \ \{}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ close(\mbox{\hyperlink{classElfParser_aed6b20ec399e0f1b3ef7fb45c00c6c10}{m\_file}});}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ std::println(\textcolor{stringliteral}{"{}ELF\ file\ closed"{}});}
\DoxyCodeLine{00079\ \ \ \ \ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classElfParser_ad33082544f3cbc0cb378dff1d8944f1b}{printElfHeader}}();}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classElfParser_a29670b3c7b4746aa8ebb830ef4674912}{printSectionHeader}}();}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classElfParser_a8d505f9991a1d1089da1c50dfc82703d}{printProgramHeader}}();}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00103\ \ \ \ \ std::variant<uint32\_t,\ uint64\_t>\ \mbox{\hyperlink{classElfParser_a7f98745f2096bf61bd02227fbbeeb2b3}{getSectionAddr}}(std::string\ \textcolor{keyword}{const}\&\ section);}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00112\ \ \ \ \ std::variant<uint32\_t,\ uint64\_t>\ \mbox{\hyperlink{classElfParser_af619a549f8e7fb62378cd79aab134cb6}{getSectionOffset}}(}
\DoxyCodeLine{00113\ \ \ \ \ \ \ std::string\ \textcolor{keyword}{const}\&\ section);}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00122\ \ \ \ \ std::variant<uint32\_t,\ uint64\_t>\ \mbox{\hyperlink{classElfParser_a2f47a16b069713eb58dec7fd5fb8a994}{getSectionSize}}(std::string\ \textcolor{keyword}{const}\&\ section);}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00131\ \ \ \ \ std::vector<std::byte>\ \mbox{\hyperlink{classElfParser_a5fa33ab74a5107e1816dfb7a4aa77484}{getSectionData}}(std::string\ \textcolor{keyword}{const}\&\ section);}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classElfParser_a814e5b369b4aaeafbabfa2f4835ada6b}{m\_elf\_class}};\ \ }
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classElfParser_aed6b20ec399e0f1b3ef7fb45c00c6c10}{m\_file}};\ \ \ \ \ \ \ }
\DoxyCodeLine{00136\ \ \ \ \ std::string\ \mbox{\hyperlink{classElfParser_a926b055d576d22cf90b8aa40dab869d7}{m\_file\_name}};\ \ }
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \ \ Elf*\ \mbox{\hyperlink{classElfParser_af077fc5dc0eb68893e380a233de38db9}{m\_elf}};\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00139\ \ \ \ \ GElf\_Ehdr\ \mbox{\hyperlink{classElfParser_a2843165838da27ed17f83f050252dfde}{m\_elfHeader}};\ \ }
\DoxyCodeLine{00140\ \ \ \ \ std::vector<GElf\_Phdr>}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \mbox{\hyperlink{classElfParser_ab9a5f66f4af77ec8d00ece1f74b1d47a}{m\_programHeader}};\ \ }
\DoxyCodeLine{00142\ \ \ \ \ std::unordered\_map<std::string,\ GElf\_Shdr>}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \mbox{\hyperlink{classElfParser_ab0bedf9485db5587e10105d290a7723e}{m\_sectionHeader}};\ \ }
\DoxyCodeLine{00144\ \ \ \ \ std::unordered\_map<std::string,\ std::vector<std::byte>>}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \mbox{\hyperlink{classElfParser_afe37f0781da83be949f99b0865293680}{m\_sectionData}};\ \ }
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classElfParser_a04ec6feb33777b100934012642b8edc4}{elfHeaderLoaded}};\ \ }
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classElfParser_a78a143ec8563a0166d611865cba1fcaa}{fileOpened}};\ \ \ \ \ \ \ }
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classElfParser_ad1ccf049355fe35ea313afc4ed3f8d80}{fileLoaded}};\ \ \ \ \ \ \ }
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classElfParser_a267398efbfb43b368038bd167ea997b0}{loadElfHeader}}();}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classElfParser_a49dc6599a415b9d7ea70af2360904816}{loadSectionHeader}}();}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classElfParser_af9bb815aa5aa30ed0f336fc6ed15f78b}{loadProgramHeader}}();}
\DoxyCodeLine{00165\ \};}

\end{DoxyCode}
